---
description: (Challenges 9-12)
---

# PicoCTF Web Exploitation 9-12

## 9. Dont-use-client-side

<details>

<summary>Provided Hints:</summary>

Never trust the client

</details>

**Description:** Can you break into this super secure portal? `https://jupiter.challenges.picoctf.org/problem/37821/` ([link](https://jupiter.challenges.picoctf.org/problem/37821/)) or http://jupiter.challenges.picoctf.org:37821

Upon clicking on the link, some possible default passwords don't seem to work. Inspect element the page and expand the HTML code.

Within the HTML code, we see the `<script>` tag, followed by JavaScript code. The `<script>` tag is used in HTML to embed a client-side script. In this case, the JS code that is embeded is a function to check for the correct password.

Throughout he function, we observe if statements to check if a split substring of checkpass matches with portions of the password. Piece together the portions of the password obviously starting with "pico" and "CTF{" to get the flag.

<figure><img src=".gitbook/assets/Screenshot_2023-06-02_13_12_27.png" alt=""><figcaption></figcaption></figure>

## 10. It is my Birthday

<details>

<summary>Provided Hints:</summary>

Look at the category of this problem.

How may a PHP site check the rules in the description?

</details>

**Description:** I sent out 2 invitations to all of my friends for my birthday! I'll know if they get stolen because the two invites look similar, and they even have the same md5 hash, but they are slightly different! You wouldn't believe how long it took me to find a collision. Anyway, see if you're invited by submitting 2 PDFs to my website. [http://mercury.picoctf.net:57247/](http://mercury.picoctf.net:57247/)

Clicking on the website, there are two file entries. Attempting to submit two-non pdfs or random pdf files gets us nowhere. The description mentions the invites having the same md5 hash and makes mention of a "collision". Additionally, the title, "It is my Birthday" makes reference to the Birthday Attack which MD5 hashes are very vulnerable to. More about the [birthday attack](https://en.wikipedia.org/wiki/Birthday\_attack).

The references to MD5 and collision in the description is regarding collisions that are possible in MD5 hash functions. Professor Selinger in his article about [MD5 Collisions ](https://www.mscs.dal.ca/\~selinger/md5collision/)states, "In March 2005, Xiaoyun Wang and Hongbo Yu of Shandong University in China published an [article](http://www.infosec.sdu.edu.cn/paper/md5-attack.pdf) in which they describe an algorithm that can find two different sequences of 128 bytes with the same MD5 hash." Further in the article, we are shown 2 pairs of executables that demonstrate an MD5 has collision. Download the Linux or Windows versions depending on your OS  and change the extension from .exe to .pdf.

Submit these files into the file entries on the website and we are given the flag.

<figure><img src=".gitbook/assets/Screenshot_2023-06-02_13_32_37.png" alt=""><figcaption></figcaption></figure>

## 11. Who are you?

<details>

<summary>Provided Hints:</summary>

It ain't much, but it's an RFC [https://tools.ietf.org/html/rfc2616](https://tools.ietf.org/html/rfc2616)

</details>

**Description:** Let me in. Let me iiiiiiinnnnnnnnnnnnnnnnnnnn [http://mercury.picoctf.net:39114/](http://mercury.picoctf.net:39114/)

In this challenge, we need to somehow gain access to the website. Upon clicking the link, We are met with a message that states only PicoBrowser users are allowed on the site. We could do this through inspect element, but assuming there will be more aspects to the HTTP header we will need to change, Burpsuite's repeater would be more efficient.

Open Burpsuite and navigate to the Proxy tab, from here, like in [#1.-get-ahead](./#1.-get-ahead "mention"), intercept the connection to the website through the Burpsuite browser. Send the response to the repeater by right clicking the response box and selecting "Send to Repeater". After sending to repeater, turn off the intercept.

In the repeater, press send to send a request to the website. Sending the intial request, we see the initial message from the website regarding having to be a PicoBrowser member.&#x20;

<figure><img src=".gitbook/assets/Screenshot_2023-06-02_14_31_58.png" alt=""><figcaption></figcaption></figure>

This requires us to change the "User-Agent" value to "PicoBrowser" in order to send a request as a PicoBrowser user. Send this request and we get another message.

<figure><img src=".gitbook/assets/Screenshot_2023-06-02_14_32_13.png" alt=""><figcaption></figcaption></figure>

This message states, "I don't trust users visiting from another site." Changing this header required a bit of research. Looking through all possible [HTTP headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers), the "Referer" header seems to be what we need to add. Add a Referer header with the same value as the host website to change what host is making the request.

<figure><img src=".gitbook/assets/Screenshot_2023-06-02_14_33_44.png" alt=""><figcaption></figcaption></figure>

Our next message states, "Sorry, this site only worked in 2018." Looking through the possible [HTTP headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers) again, the "Date" header is what we will need. Add the Date header along with a date following the syntax in 2018.

<figure><img src=".gitbook/assets/Screenshot_2023-06-02_14_34_46.png" alt=""><figcaption></figcaption></figure>

This message states, "I don't trust users who can be tracked." Searching up "track header http" leads us to the "DNT" header. This header indicates whether the user would like to be tracked or not, determined by a boolean value (0 for track, 1 for do not track).

<figure><img src=".gitbook/assets/Screenshot_2023-06-02_14_35_11.png" alt=""><figcaption></figcaption></figure>

This next message requires that our request comes from Sweden. Another very difficult header to locate, towards the end of the HTTP headers list, we need the "X-Forwarded-For" header. This header alters where our request comes from in the form of an IP address. Looking up the range for Swedish IP addresses, we can take any random IP and use it as our X-Forwarded-For value.

<figure><img src=".gitbook/assets/Screenshot_2023-06-02_14_39_58.png" alt=""><figcaption></figcaption></figure>

Our next message states, "You're in Sweden but you don't speak Swedish?" This requires us to change the already present, "Accept-Language" to the Swedish language. Looking at the HTTP [language codes](https://www.w3.org/International/ms-lang.html), replace our current language code with the Swedish language code.

<figure><img src=".gitbook/assets/Screenshot_2023-06-02_14_40_52.png" alt=""><figcaption></figcaption></figure>

Here, we are finally given the flag.

## 12. Login

<details>

<summary>Provided Hints:</summary>

(None)

</details>

**Description:** My dog-sitter's brother made this website but I can't get in; can you help?[login.mars.picoctf.net](https://login.mars.picoctf.net/)

Clicking on this website, we are shown a login page. Upon inspect elementing the page, we can't gather much from the HTML code. Instead, notice the use of a JavaScript module. Navigating to the "Sources" tab, download the JS file, and auto-format the code.

<figure><img src=".gitbook/assets/Screenshot_2023-06-02_15_13_21.png" alt=""><figcaption></figcaption></figure>

Examining the code, notice on line 11, a condition to check whether the entered password matches a string which seems to be base64 encoded. Decode the base64 in your command line by echoing the string and decoding it through the base64 command.

<figure><img src=".gitbook/assets/Screenshot_2023-06-02_15_13_34.png" alt=""><figcaption></figcaption></figure>

The decoded base64 gives us the flag for the challenge.
