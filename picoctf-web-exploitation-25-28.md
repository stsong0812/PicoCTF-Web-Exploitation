# PicoCTF Web Exploitation: 25-28

## 25. Web Gauntlet 2

<details>

<summary>Provided Hints: </summary>

I tried to make it a little bit less contrived since the mini competition.

Each filter is separated by a space. Spaces are not filtered.

There is only 1 round this time, when you beat it the flag will be in filter.php.

There is a length component now.

sqlite

</details>

**Description:** This website looks familiar... Log in as admin&#x20;

Site: [http://mercury.picoctf.net:26215/](http://mercury.picoctf.net:26215/)&#x20;

Filter: [http://mercury.picoctf.net:26215/filter.php](http://mercury.picoctf.net:26215/filter.php)

Visiting the log in site, we know that the username and password fields are vulnerable to an SQL injection. We need to use SQL code to access information from the backend database (SQLite 3). The description tells us that we want to log in as admin.

Attempting to try some default credentials for admin like admin, pass, we are told these values are filtered out. Trying a log in combination that doesn't contain any filtered characters, it is confirmed that we are not admin. But something important we see is the SQLite query and how it is formatted in the top left of the page.

<figure><img src=".gitbook/assets/Screenshot_2023-06-06_13_24_23.png" alt=""><figcaption></figcaption></figure>

Open the second link which contains a list of the filtered characters that are filtered out of the user log in input. These are the characters we will need to avoid in crafting our SQL injection payload.

<figure><img src=".gitbook/assets/Screenshot_2023-06-06_13_10_33.png" alt=""><figcaption></figcaption></figure>

We know we want the 'admin' username but we know its filtered. Knowing that SQLite supports string concatenation, we can partition admin into two separate strings and concatenate them. Additionally, all we need for the password is any statement that returns true in the SQLite database. Through some testing it appears the 'IS NOT' operator will return a value of true. Enter the newfound username and password and the flag is output to the filters page on refresh.

<figure><img src=".gitbook/assets/Screenshot_2023-06-06_13_31_18.png" alt=""><figcaption></figcaption></figure>

## 26. Picobrowser

<details>

<summary>Provided Hints:</summary>

You don't need to download a new web browser

</details>

**Description:** This website can be rendered only by picobrowser, go and catch the flag! `https://jupiter.challenges.picoctf.org/problem/26704/` ([link](https://jupiter.challenges.picoctf.org/problem/26704/)) or http://jupiter.challenges.picoctf.org:26704

The site displays a button that retrieves the flag. Attempting to press the button tells us that we are not user agent "picobrowser".

<figure><img src=".gitbook/assets/Screenshot_2023-06-06_15_17_00.png" alt=""><figcaption></figcaption></figure>

We can actually change what "user-agent" we appear as to websites. Inspect element the page and click on the three dots at the top right of the screen. Select "network conditions" and uncheck the "use default browser" option. Enter "picobrowser" as our user-agent and press the flag button.

<figure><img src=".gitbook/assets/Screenshot_2023-06-06_15_19_26.png" alt=""><figcaption></figcaption></figure>

## 27. Client-side-again

<details>

<summary>Provided Hints:</summary>

What is obfuscation?

</details>

**Description:** Can you break into this super secure portal? `https://jupiter.challenges.picoctf.org/problem/56816/` ([link](https://jupiter.challenges.picoctf.org/problem/56816/)) or http://jupiter.challenges.picoctf.org:56816

Inspect the page source, we see javascript code emebeded into the HTML code. It looks like the script is obfuscated.&#x20;

<figure><img src=".gitbook/assets/Screenshot_2023-06-06_14_35_57.png" alt=""><figcaption></figcaption></figure>

Copy the JS script and auto-format it in a code editor. We see an array of strings containing some return messages and parts of our flag.

<figure><img src=".gitbook/assets/Screenshot_2023-06-06_14_36_16.png" alt=""><figcaption></figcaption></figure>

Construct the flag and submit it.

## 28. Web Gauntlet

<details>

<summary>Provided Hints:</summary>

You are not allowed to login with valid credentials.

Write down the injections you use in case you lose your progress.

For some filters it may be hard to see the characters, always (always) look at the raw hex in the response.

sqlite

If your cookie keeps getting reset, try using a private browser window

</details>

**Description:** Can you beat the filters?&#x20;

Log in as admin [http://jupiter.challenges.picoctf.org:44979/](http://jupiter.challenges.picoctf.org:44979/) [http://jupiter.challenges.picoctf.org:44979/filter.php](http://jupiter.challenges.picoctf.org:44979/filter.php)

Attempting any default credentials for admin shows us the SQLite query at the top left of the screen.&#x20;

<figure><img src=".gitbook/assets/Screenshot_2023-06-06_16_11_09.png" alt=""><figcaption></figcaption></figure>

We can use the query as a guide to how we are going to construct our SQL injection payload. Additionally, looking at the filtered words page, we see we can't use the "or" operator. We know the username will be admin, we just need to bypass the password. We can utilize the '--' operator after our admin string to comment out the rest of the query after username.

```
Username: admin'--
Password: (anything excluding filtered strings)
```

Entering these credentials brings us to round 2. Remember to refresh the filters page every round we advance. Now, "or", "and", "like", "=", and "--" are all filtered. It looks like we can't use '--' to comment our password request. Another way we can comment something is with the "/\*" operator. Adjust our payload with the new operator in place of the filtered one.

```
Username: admin'/*
Password: (anything excluding filtered strings)
```

This moves us on to round 3. Looking at the new filtered words, luckily for us, it looks like we can use the same exact payload that we had used in round 2.

```
Username: admin'/*
Password: (anything excluding filtered strings)
```

Now onto round 4. It looks like we can still use a similar method, but this time, the string "admin" will be filtered out. Knowing that we can concatenate strings will help us submit admin without explicitly entering the fulls string. Using the "||" concatenation operator, we can concatenate "adm' || 'in'; including the ";" operator to end the statement there.

```
Username: ad'||'min';
Password: *anything excluding filtered strings)
```

Looking at round 5's filtered words, it looks like we can use the same payload we had just used. Enter the payload and again, check the filters page for our flag.

```
Username: ad'||'min';
Password: *anything excluding filtered strings)
```

<figure><img src=".gitbook/assets/Screenshot_2023-06-06_16_39_46.png" alt=""><figcaption></figcaption></figure>
