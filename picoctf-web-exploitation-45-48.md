# PicoCTF Web Exploitation: 45-49

## 45. JaWT Scratchpad

<details>

<summary>Provided Hints:</summary>

What is that cookie?

Have you heard of JWT

</details>

**Description:** Check the admin scratchpad! `https://jupiter.challenges.picoctf.org/problem/63090/` or http://jupiter.challenges.picoctf.org:63090

**Writeup:** Log in with any username and observe the cookies stored within the site.&#x20;

<figure><img src=".gitbook/assets/Screenshot_2023-06-11_10_47_03.png" alt=""><figcaption></figcaption></figure>

We know this is a JSON Web Token (JWT) as it consists of three part (header, payload, and signature) separated by periods ("."). It looks like we're going to need to alter the JWT but first we need to find the secret key used to sign the token. To do this, we can use [Hashcat](https://hashcat.net/hashcat/), which comes default on Kali Linux.&#x20;

<figure><img src=".gitbook/assets/Screenshot_2023-06-11_10_47_25 (1).png" alt=""><figcaption></figcaption></figure>

Hashcat has successfully brute forced the signing key. Now on [https://jwt.io/](https://jwt.io/), we can decode the token with the key and alter it. Paste the token and change the key to our cracked key, also changing the username to "admin".

<figure><img src=".gitbook/assets/Screenshot_2023-06-11_10_56_00.png" alt=""><figcaption></figcaption></figure>

Paste our new token in place of our old one and refresh the page. Now we are given the flag in the user entry field.

<figure><img src=".gitbook/assets/Screenshot_2023-06-11_10_57_17.png" alt=""><figcaption></figcaption></figure>

## 46. Java Script Kiddie

<details>

<summary>Provided Hints:</summary>

This is only a JavaScript problem

</details>

**Description:** The image link appears broken... https://jupiter.challenges.picoctf.org/problem/58112 or http://jupiter.challenges.picoctf.org:58112

**Writeup:** Looking at the site's source code, it looks like the application fetches an array of bytes from a server, performs some byte shifting based on user input, and displays the resulting image on the web page.

<figure><img src=".gitbook/assets/Screenshot_2023-06-11_11_18_54.png" alt=""><figcaption></figcaption></figure>

It looks like the code expects the user input to be 16 characters long. Upon inputting a 16 character  string we get a broken png like we do with any other input. We see a get request for bytes to fill our array. Lets try navigating to bytes.

<figure><img src=".gitbook/assets/Screenshot_2023-06-11_11_21_06.png" alt=""><figcaption></figcaption></figure>

Now we have the list of bytes that are used in the code. We can use [RapidTables](https://www.rapidtables.com/convert/number/ascii-hex-bin-dec-converter.html) to convert from Decimal (bytes) to hexadecimal. Copy our converted hexadecimal string and ehco it into xxd.

<figure><img src=".gitbook/assets/Screenshot_2023-06-11_12_03_49.png" alt=""><figcaption></figcaption></figure>

Now open the file in any hex editor, I used one online called [HexEd](https://hexed.it/). We know that our first 16 bytes must be the same as a png's. According to [Wikipedia](https://en.wikipedia.org/wiki/PNG), the .png extension and IHDR make up our first 16 bytes.

```
89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52
```

In our hex editor, we need to find what value the bytes have been shifted to and note down the shift. The resulting shifts will be the key that we use to obtain the flag.

<figure><img src=".gitbook/assets/Screenshot_2023-06-11_12_06_48.png" alt=""><figcaption></figcaption></figure>

{% hint style="info" %}
Our first byte needs to be 89, we see it has been shifted down 4 units. Our first shift is 4.
{% endhint %}

Note that 00 bytes in the same column up to the 9th row are possibilities to we need to note both row numbers down. Keep going until the 16th byte, my possible keys looked like this.

```
4, 8, 9, 4, 7, 4, 8, 4, 8, 5 6, 1 2, 6, 7, 1, 0, 4

# 5 6 and 1 2 show the two possible byte shift combinations
```

Manually entering the possible combinations we eventually get a QR code we can scan. Luckily my first combination "4894748485167104" worked. Scanning the QR code gives us our flag.

<figure><img src=".gitbook/assets/Screenshot_2023-06-11_12_14_03.png" alt=""><figcaption></figcaption></figure>

## 47. Java Script Kiddie 2

<details>

<summary>Provided Hints:</summary>

This is only a JavaScript problem

</details>

**Description:** The image link appears broken... twice as badly... https://jupiter.challenges.picoctf.org/problem/42899 or http://jupiter.challenges.picoctf.org:42899

**Writeup:** Looking at the source code for this challenge, it appears only a few things are different from the last. Our key is now twice as long, but our shifter only looks at every other digit.

<figure><img src=".gitbook/assets/Screenshot_2023-06-11_12_33_06.png" alt=""><figcaption></figcaption></figure>

Like in our last challenge, we wan to navigate to /bytes and convert the used bytes into hexadecimal form using [RapidTables](https://www.rapidtables.com/convert/number/ascii-hex-bin-dec-converter.html). We then want to use echo and xxd to write the hex to a file and open it in a hex editor.

<figure><img src=".gitbook/assets/Screenshot_2023-06-11_12_35_01.png" alt=""><figcaption></figcaption></figure>

We want find the shift again, making sure our first 16 bytes are the same 16 bytes as a png file. My shifts turned out to be:

```
7, 6, 1, 6, 0, 7, 9, 1, 5, 0 1, 0 1, 0, 2, 0, 8 , 5
```

Now back on the website we want to enter each shift we found twice as the code only looks at every other digit. Luckily the first key, 77661166007799115500000022008855, worked. We get another QR code and scanning it gives us our flag.

<figure><img src=".gitbook/assets/Screenshot_2023-06-11_12_39_18.png" alt=""><figcaption></figcaption></figure>

## 48. Bithug

<details>

<summary>Provided Hints:</summary>

Every user gets their own target repository to attack called /\<user>.git, but no permission to read it.

</details>

**Description:** Code management software is way too bloated. Try our new lightweight solution, BitHug.\
Source: [distribution.tgz](https://venus.picoctf.net/static/fa09f347d559b6ae3c0824921f38a6ff/distribution.tgz)

Additional details will be available after launching your challenge instance.

**Writeup:** Download the source files and extract them.&#x20;

\------------------------------------UNDER CONSTRUCTION----------------------------------------
