---
description: (Challenges 17-20)
---

# PicoCTF Web Exploitation: 17-20

## 17. Findme

<details>

<summary>Provided Hints:</summary>

(None)

</details>

**Description:** Help us test the form by submiting the username as `test` and password as `test!` Additional details will be available after launching your challenge instance.

Launch the instance and visit the website. Log in with the provided credentials, we are taken to a page that asks us to help search for the flag. Trying different entries doesn't get us anywhere.

The message below mentions redirection, try going back to the login page. Log in with the same credentials once more and observe the redirection in the search bar. It looks like we are initially directed to a different URL before being redirected to the entry page. We can confirm this by inspect elementing the log in page and navigating to the "Network" tab. Log in again to trigger the redirection and we can see different pages quickly appearing and disappearing under the Network tab.

<figure><img src=".gitbook/assets/Screenshot_2023-06-04_09_35_11.png" alt=""><figcaption></figcaption></figure>

Open Burpesuite, we want to capture the initial login request to better view the redirection. Turn off the intercept and open Burpsuite's built-in browser. We want to capture the request after we log in so type in the credentials and then turn the intercept on. Log in and the response will be mirrored on the Burpsuite app.

We can forward the response one at a time to see the different redirections. Observe GET header which includes the directory we are directed to. This looks like a base64 encoded string, we can decode this string through the command line. Type "echo "base64 string" | base64 --decode". We get one half of the flag.

<figure><img src=".gitbook/assets/Screenshot_2023-06-04_09_06_10.png" alt=""><figcaption></figcaption></figure>

Forward the request once more, and again, we are given another base64 encoded string in the GET header. Decode this base64 string too.

<figure><img src=".gitbook/assets/Screenshot_2023-06-04_09_20_00.png" alt=""><figcaption></figcaption></figure>

<figure><img src=".gitbook/assets/Screenshot_2023-06-04_09_20_18.png" alt=""><figcaption></figcaption></figure>

Piece together both halves of the flag.

## 18. MatchTheRegex

<details>

<summary>Provided Hints:</summary>

(None)

</details>

**Description:** How about trying to match a regular expression. Additional details will be available after launching your challenge instance.

Launch the instance in the challenge window and visit the website. We are shown a "Valid Input" entry window. Attempting a random input gives the message, "wrong match! Try again!"

Inspect element the page and observe the HTML code. We see a send\_request() function that seems to send a request to the server with the user input as a parameter and displays the value of the flag.&#x20;

Additionally, we see a comment referencing the "val" initialization with what seems to be the expression needed for the valid input. This looks similar to the start of every flag, "picoCTF". The "regex" mentioned in the challenge title, is defined as "A sequence of characters that specifies a match pattern in text." ([Wikipedia](https://en.wikipedia.org/wiki/Regular\_expression)).&#x20;

We could use any iteration of the regular expression provided through the comments as long as we have a "p" and an "F" in the same position as in the comments.

<figure><img src=".gitbook/assets/Screenshot_2023-06-04_10_21_05.png" alt=""><figcaption></figcaption></figure>

## 19. SOAP

<details>

<summary>Provided Hints:</summary>

(None)

</details>

The web project was rushed and no security assessment was done. Can you read the /etc/passwd file? Additional details will be available after launching your challenge instance.

Launch the instance and visit the web portal. From the name of the challenge, we know the website uses "SOAP" (Simple Object Access Protocol), "a messaging protocol specification for exchanging structured information in the implementation of web services in computer networks." Additionally, we know it utilizes XML for its message format. In the inspected HTML code of the page, observe the use of XML when the "details" button is pressed.

The description asks us to read the /etc/passwd file, to do this, we will need to take advantage of a SOAP XML inection (XXE). This vulnerability allows an attacker to view the files of the website's filesystem.&#x20;

Looking up SOAP XML payloads, we want to find one that will result in a Local File Inclusion ( a technique in which attackers trick a web application into either running or exposing files).  [Portswigger](https://portswigger.net/web-security/xxe) has a list of XML external entity (XXE) injections, looking through this article, we see a payload to retrieve files.

Open Burpsuite, turn the intercept off until the website is opened. We want to intercept our details request, turn the intercept on and press the details button. Upon interception, we can forward the XXE payload to read the passwd file. Follow the given payload syntax where we see the XML data in our Proxy window.

{% hint style="info" %}
\<?xml version="1.0" encoding="UTF-8"?>&#x20;

\<!DOCTYPE pico \[ \<!ENTITY xxe SYSTEM "file:///etc/passwd">]>&#x20;

\<ID>\&xxe;\</ID>
{% endhint %}

<figure><img src=".gitbook/assets/Screenshot_2023-06-04_17_56_44.png" alt=""><figcaption></figcaption></figure>

Forward the payload and on the page, we are shown the contents of passwd which contains the flag.

<figure><img src=".gitbook/assets/Screenshot_2023-06-04_17_57_09.png" alt=""><figcaption></figcaption></figure>

## 20. Some Assembly Required 2

<details>

<summary>Provided Hints:</summary>

(None)

</details>

**Description:** [http://mercury.picoctf.net:15406/index.html](http://mercury.picoctf.net:15406/index.html)

Similar to [#5.-some-assembly-required-1](picoctf-web-exploitation-5-8.md#5.-some-assembly-required-1 "mention"), we can observe the HTML page includes JS code. Navigate to the "Sources" bar to our JS file. Notice that again, the code is obfuscated. If your browser gives you an option to "pretty print" (format) the code do that. If not, copy and paste the code into a deobfuscator, or what I will do, copy and paste the code into vscode and auto-format it.

<figure><img src=".gitbook/assets/Screenshot_2023-06-04_18_19_50.png" alt=""><figcaption></figcaption></figure>

Once again, the code seems to fetch a WebAssembly module. Going back into our Sources, expand the "wasm" folder and analyze the module. The module seems to utilize both a "strcmp" and "check\_flag" function to compare two null-terminated strings and checks the flag by comparing the string located in memory. Additionally, we can see a string that seems to be encoded at the end. Observing the code block above the string, notice this...

```
    block $label0
      local.get $var5
      i32.eqz
      br_if $label0
      local.get $var4
      i32.load offset=12
      local.set $var6
      i32.const 8
      local.set $var7
      local.get $var6
      local.get $var7
      i32.xor
      local.set $var8
      local.get $var4
      local.get $var8
      i32.store offset=12
    end $label0
```

A value of 8 is loaded as a constant and stored in $var7. The program then preforms a bitwise XOR operation between $var6 and $var7. Based on these observations, we can conclude the provided string is XOR encoded with the value 8.&#x20;

Entering our given string into [CyberChef's XOR Brute Force](https://gchq.github.io/CyberChef/#recipe=XOR\_Brute\_Force\(1,100,0,'Standard',false,true,false,''\)\&input=eGFrZ0tcNWNOc21uO2o4ajw5Ozw/PWw/azg4bW0xbjlpMWo%2BOjhrP2wwdQ), we can see the flag at key 8.

<figure><img src=".gitbook/assets/Screenshot_2023-06-04_19_10_45.png" alt=""><figcaption></figcaption></figure>
